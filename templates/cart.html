{% extends 'base.html' %}
{% block content %}
<h1>Your Cart</h1>
{% if errors.cart %}<div class="error">{{ errors.cart }}</div>{% endif %}
<div class="cart-items">
    {% for item in items %}
    <div class="cart-row">
        <div>
            <h3>{{ item.artwork.title }}</h3>
            <p class="muted">{{ item.artwork.category }}</p>
        </div>
        <div>{{ item.qty }} x {{ format_currency(item.artwork.price) }}</div>
        <div class="price">{{ format_currency(item.line_total) }}</div>
        <form method="POST" action="{{ url_for('cart_remove', artwork_id=item.artwork.id) }}">
            <button class="btn ghost" type="submit">Remove</button>
        </form>
    </div>
    {% else %}
    <p>Your cart is empty.</p>
    {% endfor %}
</div>
<div class="cart-summary">
    <h3>Total: {{ format_currency(total) }}</h3>
</div>
<form class="checkout-form" method="POST" action="{{ url_for('checkout') }}">
    <h2>Checkout (COD)</h2>
    <label>Name</label>
    <input type="text" name="name" value="{{ form_data.get('name','') }}">
    {% if errors.name %}<span class="error">{{ errors.name }}</span>{% endif %}
    <label>Phone</label>
    <input type="text" name="phone" value="{{ form_data.get('phone','') }}">
    {% if errors.phone %}<span class="error">{{ errors.phone }}</span>{% endif %}
    <label>Address</label>
    <textarea name="address">{{ form_data.get('address','') }}</textarea>
    {% if errors.address %}<span class="error">{{ errors.address }}</span>{% endif %}
    {% if errors.stock %}<span class="error">{{ errors.stock }}</span>{% endif %}
    <button class="btn primary" type="submit">Place COD Order</button>
</form>
{% endblock %}
